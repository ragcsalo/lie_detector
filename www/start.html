<!DOCTYPE html>

<html>
    
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta id="viewport" name="viewport" content="user-scalable=yes, initial-scale=1, maximum-scale=1, minimum-scale=1" />

    <link href="css/ratchet.css" rel="stylesheet">

    <script type="text/javascript" src="cordova.js"></script>

    <script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.touchSwipe.js"></script>
    <script type="text/javascript" src="js/ratchet.js"></script>

    <script type="text/javascript" src="languages/eng.js"></script>

    <style>

      html {
        background-color:black;
        background:black;
        width:100%;
        height:100%;
      }

      @font-face {
        font-family: betutipus;
        src: url('fonts/new_academy.ttf');
      }
      @font-face {
        font-family: enigma;
        src: url('fonts/enigma.ttf');
      }
      
      .slide, .noselect {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      .slide {
        width:100%;
        height:100%; 
        text-align:center;
        padding:10px;
        position:relative;
      }

      img {
        margin:5px;
      }


    </style>

    <script type="text/javascript">

      var storage;
      var reggelve;

      var zoomin, megvasarolva, elofizetve, elofiz_ervenyes, dev_uuid;
      var kilep_szamol=0, valasztott_nyelv, hogylephetki;

      var pozicio, szindozito, predozito, torolzito;
      var lapszam=0, oldalszam=0, kepszam, szines=false;

      var keverve, kesleltet, szinezodik, modszer, folyamatos, sotetebb;

      var lap_1 = [1,2,3,4,5,6,7,8];
      var lap_2 = [1,2,3,4,5,6,7,8];
      var lap_3 = [1,2,3,4,5,6,7,8];
      var lap_4 = [1,2,3,4,5,6,7,8];
      var lap_5 = [1,2,3,4,5,6,7,8];
      var lap_6 = [1,2,3,4,5,6,7,8];
      var lap_7 = [1,2,3,4,5,6,7,8];
      var lap_8 = [1,2,3,4,5,6,7,8];

      document.addEventListener("deviceready", onDeviceReady, false);

      function onDeviceReady() {
        screen.lockOrientation('landscape');

        window.plugins.insomnia.keepAwake();

        storage = window.localStorage;

        zoomin = storage.getItem("zoomin");
        zoomin = Math.round(parseFloat(zoomin)*100)/100;

        folyamatos = logikai(storage.getItem("folyamatos"));

        keverve = logikai(storage.getItem("keverve"));
        kesleltet = parseInt(storage.getItem("kesleltet"));
        szinezodik = parseInt(storage.getItem("szinezodik"));
        modszer = storage.getItem("modszer");

        hogylephetki = storage.getItem("hogylephetki");
        if (hogylephetki==null) {
          hogylephetki=0;
        }

        megvasarolva = 1;

        dev_uuid="";

        valasztott_nyelv = storage.getItem("valasztott_nyelv");
        if (valasztott_nyelv==null) {
          valasztott_nyelv="eng";
        }


        reggelve=true;

        set_language(valasztott_nyelv);
        if (!folyamatos) {
          aktualis_slide(0);
        }

        $("body").swipe({
          swipe:function(event, direction, distance, duration, fingerCount){
            if (fingerCount==2 && direction=='up') {
              kilepes();
            }
            else if (false && fingerCount==1 && direction=='up') {
              var parameterek = 'user-scalable=yes, initial-scale='+zoomin+', minimum-scale='+zoomin+', maximum-scale='+zoomin;
              $("#viewport").attr('content',parameterek);
              alert('zoom: '+zoomin+'x');
              zoomin+=0.1;
              $('#oldal').hide().fadeIn();
            }
            else if (fingerCount==1 && direction=='down') {
              Pebble.setAppUUID("7b4e607b-ecbd-4b91-a489-3a69926ec555", 
                  function() { 
                      Pebble.onConnect(function(event) { 
                          alert('Pebble connected!');
                          Pebble.onAppMessageReceived(function(message){
                              alert(message);
                          });

                          Pebble.sendAppMessage({0: "hello"},
                              function() { alert('message sent'); });
                      });
                  }
              );            }
            else if (false && fingerCount==2 && direction=='down') {
              alapkeparany();
              $('#oldal').hide().fadeIn();
            }
          },
          fingers:'all',
          allowPageScroll:'horizontal',
          preventDefaultEvents:false
        });

      }

      function set_language(mire) {
        $.getScript('languages/'+mire+'.js', function() {
          kilepes_modja();
          betoltve();
        });
      }

      function kilepes() {
        kilep_szamol+=1;
        if (kilep_szamol==3) {
          clearTimeout(szindozito);
          kilep_szamol=0;
          navigator.notification.confirm(
            txt_mitakar,
            function(idx) {
              if (idx==1) {
                storage.setItem("kilepett",true);
                top.location='index.html';
              }
              else if (idx==3) {
                top.location='start.html';
              }
              else {
                if (lapszam>0) {
                  szindozito = setTimeout(szinesit,kesleltet*1000);
                }
              }
            },
            txt_mit_valaszt,
            [txt_mit_kilep,txt_mit_folyt,txt_mit_ujat]
          );
        }
      }


      function logikai(mibol) {
        if (mibol==true || mibol=="true") {
          return true;
        }
        else {
          return false;
        }
      }

      function kilepes_modja() {
        if (hogylephetki==0) {
          navigator.notification.confirm(
            txt_kilepes,
            function(idx) {
              if (idx==2) {
                storage.setItem("hogylephetki",1);
              }
            },
            txt_kilep,
            [txt_ujra,txt_megertette]
          );
        }
      }



      function betoltve() {
        $("#oldal").hide;
        //ujkeparany();
        lap_1.sort(veletlen);
        lap_2.sort(veletlen);
        lap_3.sort(veletlen);
        lap_4.sort(veletlen);
        lap_5.sort(veletlen);
        lap_6.sort(veletlen);
        lap_7.sort(veletlen);
        lap_8.sort(veletlen);

        setTimeout(kepek_kiirasa,500);
      }

      function alapkeparany() {
        zoomin = storage.getItem("zoomin");
        zoomin = Math.round(parseFloat(zoomin)*100)/100;
        var parameterek = 'user-scalable=yes, initial-scale=1, minimum-scale=1, maximum-scale=1';
        $("#viewport").attr('content',parameterek);
      }

      function hiba() {
      }

      function siker() {
      }

      function uzenet_ablak(cime,szovege) {
        navigator.notification.alert(szovege, siker, cime, 'OK')
      }

      function ketszamjegyu(ez) {
        if (ez<10) {
          ez = '0'+ez;
        }
        return ez;
      }

      function kulcsok(obj){
         var keys = [];
         for(var key in obj){
           if (obj.hasOwnProperty(key)) {
             keys.push(key);
           }
         }
         return keys;
      }


      function aktualis_slide(ez) {
        if (!szines) {
          var sorszam = (0-ez)+1;
          oldalszam = sorszam;
          pozicio = sorszam+'.';
          clearTimeout(szindozito);
          clearTimeout(predozito);
          if (lapszam>0) {
            szindozito = setTimeout(szinesit,kesleltet*1000);
            predozito = setTimeout(preszinesit,3000);
          }
        }
      }

      function idozito_nullaz() {
        clearTimeout(szindozito);
        clearTimeout(predozito);
        if (lapszam>0 && !szines) {
          szindozito = setTimeout(szinesit,kesleltet*1000);
          predozito = setTimeout(preszinesit,3000);
        }
      }

      function szinesit() {
        clearTimeout(torolzito);
        if (!szines) {
          if (folyamatos) {
            var i, elem, bal, jobb, fele, szeles, elemid_sz;

            szeles = $('#oldal').width();
            
            for (i=1; i<=8; i++) {
              elem = $('#kep'+i+'_'+lapszam+'_ff');
              bal = elem.offset().left;
              jobb = bal + elem.width();
              fele = bal + parseInt(elem.width()/2);

              if (fele>=0 && fele<szeles) {
                elemid_sz = 'kep' + i + '_' + lapszam + '_sz';
                i=10;
              }
            }
          }
          else {
            var elemid_sz = 'kep' + oldalszam + '_' + lapszam + '_sz';
          }

          clearTimeout(szindozito);
          szines=true;
          $("#"+elemid_sz).css('opacity',100);
        }
      }

      function preszinesit() {
        //clearTimeout(torolzito);
        if (!szines) {
          if (folyamatos) {
            var i, elem, bal, jobb, fele, szeles, elemid_sz;

            szeles = $('#oldal').width();
            
            for (i=1; i<=8; i++) {
              elem = $('#kep'+i+'_'+lapszam+'_ff');
              bal = elem.offset().left;
              jobb = bal + elem.width();
              fele = bal + parseInt(elem.width()/2);

              if (fele>=0 && fele<szeles) {
                elemid_sz = 'kep' + i + '_' + lapszam + '_sz';
                i=10;
              }
            }
          }
          else {
            var elemid_sz = 'kep' + oldalszam + '_' + lapszam + '_sz';
          }
          clearTimeout(predozito);
        }
      }

      function melyiklap(ezalap) {
        if (!szines && lapszam==0) {
          lapszam = ezalap;
          var lapkuld = lapszam;
          if (sotetebb) {
            lapkuld += '_dim';
          }
          $('#startol').fadeOut(1000);
          clearTimeout(szindozito);
        }
      }

      function veletlen(a, b) {
        return 0.5 - Math.random();
      }


      function kepek_kiirasa() {
        var aktualis_oldal, html_szoveg;
        var poziciok = [1,2,3,4,5,6,7,8];
        var pozik, i, holvan, lapja, nagyszeles;

        nagyszeles = $('#oldal').width()*8;

        if (folyamatos) {
          html_szoveg='<div id="mySlider" style="padding-top:20px; box-sizing: border-box; width:'+nagyszeles+'px; height:100%; text-align:center; overflow:hidden" onTouchstart="idozito_nullaz()"></div>';
        }
        else {
          html_szoveg='<div class="slider" id="mySlider" style="margin-top:20px; width:100%; height:100%; text-align:center; overflow:hidden"><div class="slide-group" id="csoport" style="width:100%; height:100%; text-align:center"></div></div>';
        }
        $('#oldal').prepend(html_szoveg);

        for (aktualis_oldal=1; aktualis_oldal<=8; aktualis_oldal++) {
          html_szoveg='';
          
          if (folyamatos) {
            html_szoveg += '<div style="padding:10px; position:relative; float:left; width:'+$('#oldal').width()+'px; height:'+$('#oldal').height()+'px; color:white; font-size:60pt; text-align:center"><br><br><br>';
          }
          else {
            html_szoveg += '<div class="slide" style="color:white; font-size:60pt;"><br><br><br>';
          }

          pozik = poziciok;
          
          if (folyamatos && keverve) {
            if (aktualis_oldal==1 || aktualis_oldal==3 || aktualis_oldal==4 || aktualis_oldal==6) {
              pozik = [5,6,7,8,1,2,3,4];
            }
            else {
              pozik = [1,2,3,4,5,6,7,8];
            }
          }
          else if (keverve) {
            pozik.sort(veletlen);
          }

          for (i=0; i<8; i++) {
            lapja = window['lap_'+pozik[i]].shift();
            if (aktualis_oldal==1 && modszer=='erintes') {
              html_szoveg += '<img id="kep'+aktualis_oldal+'_'+pozik[i]+'_ff" src="szurke/'+lapja+'-'+pozik[i]+'.png" width="23%" class="hol'+(i+1)+'" onTouchstart="melyiklap('+(i+1)+')">';
              html_szoveg += '<img id="kep'+aktualis_oldal+'_'+pozik[i]+'_sz" src="szines/'+lapja+'-'+pozik[i]+'.png" width="23%" class="hol'+(i+1)+' nemlatszik" onTouchstart="melyiklap('+(i+1)+')">';
            }
            else {
              html_szoveg += '<img id="kep'+aktualis_oldal+'_'+pozik[i]+'_ff" src="szurke/'+lapja+'-'+pozik[i]+'.png" width="23%" class="hol'+(i+1)+'">';
              html_szoveg += '<img id="kep'+aktualis_oldal+'_'+pozik[i]+'_sz" src="szines/'+lapja+'-'+pozik[i]+'.png" width="23%" class="hol'+(i+1)+' nemlatszik">';
            }
          }

          html_szoveg += '</div>';

          if (folyamatos) {
            $('#mySlider').append(html_szoveg);
          }
          else {
            $('#csoport').append(html_szoveg);
          }
        }

        if (modszer=='startnow') {
          $('#startol').show();
        }

        $('img').css('transition', 'opacity '+szinezodik+'s ease-in');

        $("#oldal").fadeIn(1000);

      }


    </script>

    <style>
      .hol1 { position:absolute; top:0%; left:0%; }
      .hol2 { position:absolute; top:0%; left:25%; }
      .hol3 { position:absolute; top:0%; left:50%; }
      .hol4 { position:absolute; top:0%; left:75%; }
      .hol5 { position:absolute; top:50%; left:0%; }
      .hol6 { position:absolute; top:50%; left:25%; }
      .hol7 { position:absolute; top:50%; left:50%; }
      .hol8 { position:absolute; top:50%; left:75%; }
      .nemlatszik { opacity:0; }

      table {
        background:#17457d;
        opacity:0.8;
        border:0px;
        margin:0px;
        position:absolute;
        height:200px;
        top:80px;
        font-family:enigma;
        font-size:60pt;
        color:#ffcc66;
        font-weight:bold;
        border-radius:40px;
        display:block;
        width: 400px;
        left:0;
        right:0;
        margin-left:auto;
        margin-right:auto;
      }

      td {
        padding-top: 20px;
        height: 100px;
        width: 80px;
        vertical-align:center;
        text-align:center;
        box-sizing: border-box;
        border:0px;
        margin:0px;
      }

      tr {
        border:0px;
        margin:0px;
      }

      ::-webkit-scrollbar { 
        display: none;
      }

    </style>


</head>


<body class="noselect" style="background:#000000; font-size:20pt; width:100%; height:100%; overflow:hidden; position:fixed; margin:0px; padding:0px; border:0px; font-family:Helvetica">

  <div class="noselect" id="oldal" style="background:#000000; display:none; width:100%; height:100%; position:fixed; text-align:center; overflow-x:scroll; overflow-y:hidden; -webkit-overflow-scrolling: touch">

    <table id="startol" align="center" border="0" cellspacing="0" style="display:none">
      <tr>
        <td onTouchstart="melyiklap(1)" style="border-top-left-radius:40px;">S</td>
        <td onTouchstart="melyiklap(2)">T</td>
        <td onTouchstart="melyiklap(3)">A</td>
        <td onTouchstart="melyiklap(4)">R</td>
        <td onTouchstart="melyiklap(5)" style="border-top-right-radius:40px;">T</td>
      </tr>
      <tr>
        <td style="border-bottom-left-radius:40px;">&nbsp;</td>
        <td onTouchstart="melyiklap(6)">N</td>
        <td onTouchstart="melyiklap(7)">O</td>
        <td onTouchstart="melyiklap(8)">W</td>
        <td style="border-bottom-right-radius:40px;">&nbsp;</td>
      </tr>
    </table>


  </div>


</body>

</html>